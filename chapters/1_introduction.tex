\section{Introduction}

\subsection{Motivation}
Nowadays a car is full of small computers handling tasks for the whole system. Without these helpers, functions like driver-assistance or self-diagnostic would not be possible. Those computers are generally called ECUs (Electronic control unit). Modern cars can contain over 100 of those. The complexity of ECU networks in a car is increasing quickly. The next generation of car networks is expected to be more centralized with less ECUs. This reduces complexity and its inherent risk of security vulnerabilities and high costs.

ECUs communicate with each other via bus systems. The most common ones are CAN, FlexRay and the Automotive Ethernet, which is becoming increasingly popular. On top of these physical layers are usually sitting Transport protocols. For Ethernet this is the well known TCP protocol, while the most common one for CAN is the ISOTP protocol. To finally transmit payload, application protocols are used. For example, some protocols were created specifically for the development of units like XCP (Universal Measurement and Calibration Protocol) and some others were defined for diagnostic purposes such as UDS (Unified Diagnostic Services), GMLAN (General Motors Local Area Network) and OBD (On-board diagnostics). Both types are security critical. The XCP protocol is able to read and even write into the flash memory of an ECU. It shall be disabled on shipped ECUs. The UDS and GMLAN protocol provide definitions for diagnostic related tasks. However, diagnostic protocols are explicitly designed for actively used cars and thus are exposed to the easily accessible OBD-II port. This fact makes them a great first target for gathering information. This work puts the UDS protocol in focus since it is the widest adopted protocol which allows extended functionality, for example flashing ECUs. The OBD protocol is excluded in this work because it does not offer any valuable information and the GMLAN protocol because it is restricted to vehicles from the General Motors corporation.

The initial step in testing a system for weaknesses is to gather as much information from it as possible. Most commonly, an ECU does not have to support all services defined by a diagnostic protocol and a subset is sufficient. And sometimes, there is even no fixed address where a specific service can be reached.
Furthermore, a diagnostic protocol can define various states. The ECU may show varying behaviors in different states, for example support for other services. Since this kind of information is highly relevant for the security of the ECU, it would be helpful for security testers to gain this knowledge quickly and automatically.

One option to achieve this is to send all possible requests to an ECU and evaluate the responses. In the context of the project \emph{PetS3} (Penetration Test Driven Safety and Security System Improvements for Cyber-Critical Systems) such scanners have been implemented for UDS, GMLAN and OBD. With their brute-force approaches, they are effective but not efficient. A scan can take a highly variable amount of time. It can range from a few hours to a day or more. In general, the more states are found on an ECU in a scan, the more time it will need. For example, more authentication information leads to more state detections and thus to higher runtimes. In addition, the response time of the ECU is also a decisive factor.

Hence, this paper evaluates different approaches for a more efficient information gathering with automotive diagnostic protocols.

\subsection{Environment}
This work was created at eMundo GmbH in Ingolstadt.

\subsection{Outline}
outline